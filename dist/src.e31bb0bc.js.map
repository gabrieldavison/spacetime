{"version":3,"sources":["broadcastChannel.js","index.js"],"names":["bc","BroadcastChannel","console","log","notes","octave","lowOctave","highOctave","note","step","steps","playPosition","editPosition","tickRate","highRate","lowRate","playing","actions","inc","dec","bottom","top","noteRand","metroFast","metroSlow","positionRand","action","window","addEventListener","e","handleKeydown","usedKeys","includes","key","preventDefault","length","draw","canvas","document","getElementById","ctx","getContext","timer","timeToTick","Date","now","nextTick","tick","requestAnimationFrame","playNote","clearRect","width","height","widthUnit","textSpacing","x","y","i","font","fillStyle","fillText","rectangeWidth","measureText","beginPath","rect","stroke","randomIntFromInterval","postMessage","min","max","Math","floor","random"],"mappings":"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","file":"src.e31bb0bc.js","sourceRoot":"../src","sourcesContent":["export const bc = new BroadcastChannel(\"notes\");\nconsole.log(\"bc go\");\n","import { bc } from \"./broadcastChannel.js\";\n\n// Global Variables\n\nlet notes = [\"c\", \"d\", \"e\", \"f\", \"g\", \"a\", \"b\"];\nlet octave = 4;\nconst lowOctave = 2;\nconst highOctave = 6;\nlet note = 0;\nlet step = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\nlet steps = 16;\nlet playPosition = 0;\nlet editPosition = 0;\nlet tickRate = 400;\nlet highRate = 400;\nlet lowRate = 800;\nlet playing = true;\n\nconst actions = [\n  inc,\n  dec,\n  bottom,\n  top,\n  noteRand,\n  metroFast,\n  metroSlow,\n  positionRand,\n];\n\nconst action = [\"+\", \"-\", \"<\", \">\", \"*\", \"M\", \"m\", \"#\"];\n\nwindow.addEventListener(\"keydown\", (e) => handleKeydown(e));\n\nfunction handleKeydown(e) {\n  const usedKeys = [\"ArrowLeft\", \"ArrowRight\", \"ArrowUp\", \"ArrowDown\", \"Space\"];\n  if (usedKeys.includes(e.key)) {\n    e.preventDefault();\n  }\n\n  switch (e.key) {\n    case \"ArrowLeft\":\n      editPosition === 0\n        ? (editPosition = step.length - 1)\n        : (editPosition -= 1);\n      draw();\n      break;\n    case \"ArrowRight\":\n      editPosition === step.length - 1\n        ? (editPosition = 0)\n        : (editPosition += 1);\n      draw();\n      break;\n    case \"ArrowUp\":\n      step[editPosition] === 7\n        ? (step[editPosition] = 0)\n        : (step[editPosition] += 1);\n      draw();\n      break;\n    case \"ArrowDown\":\n      step[editPosition] === 0\n        ? (step[editPosition] = 7)\n        : (step[editPosition] -= 1);\n      draw();\n      break;\n    case \" \":\n      playing = !playing;\n      draw();\n      break;\n  }\n}\n\nconst canvas = document.getElementById(\"canvas\");\nconst ctx = canvas.getContext(\"2d\");\n//creates timer loop\nfunction timer() {\n  console.log(\"starting timer\");\n\n  let timeToTick = Date.now();\n  function nextTick() {\n    const now = Date.now();\n    if (timeToTick <= now && playing == true) {\n      tick();\n      timeToTick = now + tickRate;\n    }\n    requestAnimationFrame(nextTick);\n  }\n  nextTick();\n}\ntimer();\n\nfunction tick() {\n  playPosition == steps - 1 ? (playPosition = 0) : (playPosition += 1);\n\n  actions[step[playPosition]]();\n  playNote();\n  draw();\n}\n\nfunction draw() {\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n  const widthUnit = canvas.width / 10;\n  const textSpacing = (canvas.width - widthUnit * 2) / 16;\n\n  let x = widthUnit;\n  const y = canvas.height / 2;\n\n  for (let i = 0; i < 16; i++) {\n    ctx.font = \"40px serif\";\n    ctx.fillStyle = \"black\";\n    if (i === editPosition) {\n      ctx.fillStyle = \"red\";\n    }\n    ctx.fillText(action[step[i]], x, y);\n    if (i === playPosition) {\n      const rectangeWidth = ctx.measureText(step[i]).width;\n      ctx.beginPath();\n      ctx.rect(x, y - (rectangeWidth - 20), rectangeWidth, 3);\n      ctx.stroke();\n    }\n\n    x += textSpacing;\n  }\n}\n\n//****Actions******\n\n//Increments note\nfunction inc() {\n  if (note + 1 <= notes.length - 1) {\n    note += 1;\n  } else if (note + 1 > notes.length - 1 && octave < highOctave) {\n    octave += 1;\n    note = 0;\n  }\n}\n\n//Decrements note\nfunction dec() {\n  console.log(\"dec\");\n  if (note - 1 >= 0) {\n    note -= 1;\n  } else if (note - 1 < 0 && octave > lowOctave) {\n    octave -= 1;\n    note = notes.length - 1;\n  }\n}\n\n//Skips to bottom note\nfunction bottom() {\n  note = 0;\n  octave = lowOctave;\n}\n\n//Skips to top note\nfunction top() {\n  note = notes.length - 1;\n  octave = highOctave;\n}\n\n//Skips to random note in current octave\nfunction noteRand() {\n  note = randomIntFromInterval(0, notes.length - 1);\n}\n\nfunction metroFast() {\n  tickRate = highRate;\n}\n\nfunction metroSlow() {\n  tickRate = lowRate;\n}\n\nfunction positionRand() {\n  playPosition = randomIntFromInterval(0, step.length - 1);\n}\n\n//*****UTILS********\n\nfunction playNote() {\n  console.log(notes[note] + octave);\n  bc.postMessage(notes[note] + octave, \"4n\");\n}\n\nfunction randomIntFromInterval(min, max) {\n  return Math.floor(Math.random() * (max - min + 1) + min);\n}\n"]}